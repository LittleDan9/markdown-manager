{
  "service": {
    "name": "spell-check-consumer",
    "domain": "spell",
    "description": "Consumer for spell-check service identity events and user dictionaries"
  },
  "redis": {
    "consumer_group": "spell_group",
    "consumer_name": "spell_consumer_1",
    "stream_name": "identity.user.v1",
    "batch_size": 10,
    "poll_interval": 5,
    "max_retry_attempts": 3
  },
  "database": {
    "schema": "spell",
    "tables": {
      "identity_projection": {
        "primary_key": ["tenant_id", "user_id"],
        "columns": {
          "tenant_id": "UUID NOT NULL",
          "user_id": "UUID NOT NULL",
          "email": "CITEXT",
          "status": "TEXT NOT NULL",
          "updated_at": "TIMESTAMPTZ NOT NULL"
        }
      },
      "user_dict": {
        "primary_key": ["tenant_id", "user_id"],
        "columns": {
          "tenant_id": "UUID NOT NULL",
          "user_id": "UUID NOT NULL",
          "words": "JSONB NOT NULL DEFAULT '[]'",
          "version": "INT NOT NULL DEFAULT 1",
          "updated_at": "TIMESTAMPTZ NOT NULL DEFAULT now()"
        }
      },
      "event_ledger": {
        "primary_key": ["event_id"],
        "columns": {
          "event_id": "UUID PRIMARY KEY",
          "received_at": "TIMESTAMPTZ NOT NULL DEFAULT now()"
        }
      }
    }
  },
  "event_handlers": {
    "UserCreated": {
      "update_identity_projection": true,
      "create_default_dictionary": true,
      "default_dictionary": {
        "words": []
      }
    },
    "UserUpdated": {
      "update_identity_projection": true,
      "create_default_dictionary": false
    },
    "UserDisabled": {
      "update_identity_projection": true,
      "create_default_dictionary": false,
      "set_status": "disabled"
    }
  },
  "logging": {
    "level": "INFO",
    "format": "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  }
}